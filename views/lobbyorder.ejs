<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <style type="text/css">
        *{
            padding: 0;
            margin:0;
        }
        html {
            width: 100%;
            height: 100%;
        }
        body{
            background: url(/img/bg.jpg)no-repeat center center;
            background-size: cover;
        }
        .tab-pane {
            padding-top: 20px;
        }
        label {
            cursor: pointer;
        }
        .left{
            width:170px;
            height:100%;
            border-right:1px solid #ccc;
            position: absolute;
            background:#f8f8f8;
            cursor:pointer;
        }
        .left ul{
            width:170px;
        }
        .left ul li{
            width:100%;
            height:40px;
            line-height: 40px;
            text-align: left;
            font-size: 16px;
            border-bottom: 1px solid #ccc;
        }
        .left ul li a{
            text-decoration: none;
            padding-left: 20px;
        }
        .panel-heading {
            color: #777;
            border-bottom: 1px solid #ccc;
            padding-left: 20px;
        }
        .main{
            float:left;
        }
        td img{
            width:100px;
            height:100px;
        }
        input,select{
            color:#000;
        }
        h3{
            margin-left:-50px;

        }
        .modal-footer{
            border-top:0px;
        }
    </style>
</head>

<body>
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">酒店管理系统</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" >入住管理 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/lobby">大堂入住</a></li>
                        <li><a href="/zhu">订单入住</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/nohouse" class="dropdown-toggle" >退房管理</a>
                </li>
                <li>
                    <a href="/jilu" class="dropdown-toggle" >记录查询</a>
                </li>
                <li>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">房间管理 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/find">查询房间</a></li>
                        <li><a href="/guanli">新建房间</a></li>
                    </ul>
                </li>
                <li>
                    <a href="/type" class="dropdown-toggle">房类管理</a>
                </li>
                <li>
                    <a href="/tubiao" class="dropdown-toggle">图表显示</a>
                </li>
                <li>
                    <a href="/xiugai" class="dropdown-toggle">修改密码</a>
                </li>
                <li>
                    <a href="/" class="dropdown-toggle" id="tuichu" >退出登录</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

    
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main ">
                <div class="container" style="margin-top: 10px">
                                <div class="modal-body" style="color:#fff;">
                                    <form id="biaodan" action="/doadd" method="post">
                                         <h3>顾客信息:</h3>
                                        <p>
                                            证件类型:&nbsp;&nbsp;&nbsp;&nbsp;
                                            <select name="shenfen" id="shenfen" value="身份证">
                                                <option value="身份证">身份证</option>
                                            </select>
                                            
                                        </p>
                                        <p>
                                            证件号码:&nbsp;&nbsp;&nbsp;&nbsp;
                                            <input type="text" name="hao" id="hao" class="form-control" />
                                        </p>
                                        <p>
                                           姓名:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <input type="text" name="people" class="form-control" />
                                        </p>
                                        <p>性别:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <select name="sex" id="sex">
                                                <option value="男">男</option>
                                                <option value="女">女</option>
                                            </select>
                                        </p>
                                       <h3>房间信息:</h3>
                                        <p>房间类型:&nbsp;&nbsp;&nbsp;&nbsp;
                                            <select name="select" id="select">
                                            </select>
                                            
                                        </p>
                                        <p>
                                            房间号码:&nbsp;&nbsp;&nbsp;&nbsp;
                                            <select name="fangjian" id="fangjian">

                                            </select>
                                        </p>
                                        <p>房间剩余量:
                                            <input type="text" name="shengyu"  class="form-control shengyu" disabled/>
                                        </p>
                                        <p>价格:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                            <input type="text" name="price" class="form-control"  disabled/>
                                        </p>
                                        <p>入住人姓名:
                                            <input type="text" name="peoples"  class="form-control"/>
                                            (多人入住请用逗号隔开)
                                        </p>
                                        <p>离店日期:
                                            <input type="date" name="dates"  class="form-control"/>
                                        </p>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button style="float:left;" type="button" class="btn btn-default" id="btn" data-dismiss="modal">办理入住</button>
                                    <button style="float:left;" type="button" class="btn btn-primary">完成</button>
                                </div>
                </div>       
            </div>
        </div>
    </div>


    <script src="js/jquery-1.12.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
        //退出
        $("#tuichu").click(function () {
            $.get("/tuichu",function (data) {
                alert("退出成功");
                window.location="/"
            })
        })

        $.get('/leibie', function (data) {
            $("#fangjian").empty();
            $.each(data.results, function (i, n) {
                $("<option value=" + n.homename  + "></option>").html(n.homename).appendTo($('#select'));
            });
        })
        $("#select").change(function () {
            var typename=$(this).val();
            console.log(typename);
            $.get("/houses",function(data){
                $("#fangjian").empty();
                var str="";
                var data=data.results;
                $.each(data, function (i, n) {
                    if(n.type == typename && n.zhu == "未入住"){
                        str="<option>"+data[i].fangjian+"</option>";
                        $("#fangjian").append(str);
                    }
                })
            })
        })

        $("input[name=hao]").blur(function () {
            var reg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;
            if(reg.test($("input[name=hao]").val()) === false) {
                alert("身份证输入不合法");
                return false;
            }else{

            }
        })
        $("#select").change(function () {
            var This = $(this).val()
            $.get("/doaddtype",function (data) {
                // console.log(data);
                $.each(data.results,function (i,n) {
                    // console.log(n.homename)
                    if(This == n.homename){
                        $("input[name=shengyu]").val(n.yushuliang);
                        $("input[name=price]").val(n.price);
                    }
                })
            })
        })
        //添加
        $("#btn").click(function () {
            $.post("/doaddlobby", {
                shenfen:$("#shenfen").val(),
                hao:$("input[name=hao]").val(),
                people:$("input[name=people]").val(),
                sex:$("#sex").val(),
                select:$("#select").val(),
                fangjian:$("#fangjian").val(),
                peoples:$("input[name=peoples]").val(),
                dates:$("input[name=dates]").val(),
                num:$("input[name=shengyu]").val(),
                price:$("input[name=price]").val()
            }, function (data) {
                console.log(data.result);
                if (data.result == 1) {
                    alert("办理入住成功！");
                    $("input[type=text]").val("");
                } else if (data.result == -1) {
                    alert("办理入住失败");
                } else if (data.result == -2) {
                    alert("服务器错误！请联系管理员，怎么联系我也不知道！");
                }
            })
            var id =  $("#fangjian").val();
            console.log(id);
            var zhuangtai = "已入住";
            $.post("/panduan/"+id,{
                zhuangtai: zhuangtai
            },function(data) {
                if (data.result == 1) {
                    alert("成功")
                } else {
                    alert("服务器错误！请联系管理员，怎么联系我也不知道！");
                }
            })
        });




    </script>

</body>

</html>